{"version":3,"sources":["webpack:///./packages/cms/plugins/media/components/MediaLink/MediaLinkEditor.vue","webpack:///./packages/cms/plugins/media/components/MediaLink/MediaLinkEditor.vue?61b0","webpack:///./packages/cms/api/index.js","webpack:///./packages/cms/plugins/media/components/MediaLink/MediaLinkEditor.vue?7b15","webpack:///./packages/cms/plugins/media/components/MediaLink/MediaLinkEditor.vue?4a85","webpack:///./packages/cms/plugins/media/components/MediaLink/MediaLinkEditor.vue?7daa","webpack:///packages/cms/plugins/media/components/MediaLink/MediaLinkEditor.vue"],"names":["component","pageCache","httpClient","baseURL","getPage","pageId","get","getDraft","saveDraft","pageData","undefined","put","publish","getUrlDetails","url","uploadBlob","fileName","blob","formData","FormData","append","post","obtainRecord","personId","updateRecord","recordData","render","_vm","this","_h","$createElement","_c","_self","staticClass","_b","on","$event","isEditing","sanitizedValue","directives","name","rawName","value","expression","innerValue","attrs","domProps","target","composing","$set","$$selectedVal","Array","prototype","filter","call","options","o","selected","map","val","_value","multiple","_v","accept","cancel","staticRenderFns","mixins","api","components","props","type","Object","required","data","watch","immediate","handler","JSON","parse","stringify","newValue","isEmpty","computed","href","text","secondary","icon","methods","$emit","doDelete","confirm"],"mappings":"kHAAA,2DAQIA,EAAY,eACd,OACA,OACA,QACA,EACA,KACA,KACA,MAIa,aAAAA,E,6CCnBf,gBAAqZ,e,kDCAjZC,EAAY,GAED,gBAACC,GAId,OAFAA,EAAWC,QAAU,mBAEd,CACLC,QADK,SACGC,GAKN,MAJgC,oBAArBJ,EAAUI,KACnBJ,EAAUI,GAAUH,EAAWI,IAAX,uBAA+BD,KAG9CJ,EAAUI,IAGnBE,SATK,SASIF,GACP,OAAOH,EAAWI,IAAX,uBAA+BD,EAA/B,YAGTG,UAbK,SAaKH,EAAQI,GAEhB,OADAR,EAAUI,QAAUK,EACbR,EAAWS,IAAX,uBAA+BN,EAA/B,UAA+CI,IAGxDG,QAlBK,SAkBGP,GAAyB,IAAjBI,EAAiB,uDAAN,KACzB,OAAOP,EAAWS,IAAX,uBAA+BN,EAA/B,YAAiDI,IAG1DI,cAtBK,SAsBSC,GACZ,OAAOZ,EAAWI,IAAX,uBAAuC,CAAEQ,SAGlDC,WA1BK,SA0BMV,EAAQW,EAAUC,GAC3B,IAAIC,EAAW,IAAIC,SAGnB,OAFAD,EAASE,OAAO,QAASH,EAAMD,GAExBd,EAAWmB,KAAX,uBAAgChB,EAAhC,UAAgDa,IAIzDI,aAlCK,SAkCQjB,EAAQkB,GACnB,OAAOrB,EAAWI,IAAX,wBAAgCiB,EAAhC,kBAAkDlB,EAAlD,aAGTmB,aAtCK,SAsCQnB,EAAQkB,EAAUE,GAC7B,OAAOvB,EAAWS,IAAX,wBAAgCY,EAAhC,kBAAkDlB,EAAlD,WAAmEoB,O,kCC7ChF,wEAAIC,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,qBAAqB,CAACF,EAAG,SAASJ,EAAIO,GAAG,CAACD,YAAY,eAAeE,GAAG,CAAC,MAAQ,SAASC,GAAQT,EAAIU,WAAY,KAAQ,SAASV,EAAIW,gBAAe,IAAQP,EAAG,MAAM,CAACQ,WAAW,CAAC,CAACC,KAAK,OAAOC,QAAQ,SAASC,MAAOf,EAAa,UAAEgB,WAAW,cAAcV,YAAY,oBAAoB,CAACF,EAAG,QAAQ,CAACQ,WAAW,CAAC,CAACC,KAAK,QAAQC,QAAQ,UAAUC,MAAOf,EAAIiB,WAAe,KAAED,WAAW,oBAAoBV,YAAY,YAAYY,MAAM,CAAC,KAAO,OAAO,YAAc,cAAcC,SAAS,CAAC,MAASnB,EAAIiB,WAAe,MAAGT,GAAG,CAAC,MAAQ,SAASC,GAAWA,EAAOW,OAAOC,WAAqBrB,EAAIsB,KAAKtB,EAAIiB,WAAY,OAAQR,EAAOW,OAAOL,WAAWX,EAAG,QAAQ,CAACQ,WAAW,CAAC,CAACC,KAAK,QAAQC,QAAQ,UAAUC,MAAOf,EAAIiB,WAAe,KAAED,WAAW,oBAAoBV,YAAY,YAAYY,MAAM,CAAC,KAAO,OAAO,YAAc,UAAUC,SAAS,CAAC,MAASnB,EAAIiB,WAAe,MAAGT,GAAG,CAAC,MAAQ,SAASC,GAAWA,EAAOW,OAAOC,WAAqBrB,EAAIsB,KAAKtB,EAAIiB,WAAY,OAAQR,EAAOW,OAAOL,WAAWX,EAAG,QAAQ,CAACQ,WAAW,CAAC,CAACC,KAAK,QAAQC,QAAQ,UAAUC,MAAOf,EAAIiB,WAAoB,UAAED,WAAW,yBAAyBV,YAAY,YAAYY,MAAM,CAAC,KAAO,OAAO,YAAc,eAAeC,SAAS,CAAC,MAASnB,EAAIiB,WAAoB,WAAGT,GAAG,CAAC,MAAQ,SAASC,GAAWA,EAAOW,OAAOC,WAAqBrB,EAAIsB,KAAKtB,EAAIiB,WAAY,YAAaR,EAAOW,OAAOL,WAAWX,EAAG,SAAS,CAACQ,WAAW,CAAC,CAACC,KAAK,QAAQC,QAAQ,UAAUC,MAAOf,EAAIiB,WAAiB,OAAED,WAAW,sBAAsBV,YAAY,YAAYE,GAAG,CAAC,OAAS,SAASC,GAAQ,IAAIc,EAAgBC,MAAMC,UAAUC,OAAOC,KAAKlB,EAAOW,OAAOQ,SAAQ,SAASC,GAAG,OAAOA,EAAEC,YAAWC,KAAI,SAASF,GAAG,IAAIG,EAAM,WAAYH,EAAIA,EAAEI,OAASJ,EAAEd,MAAM,OAAOiB,KAAOhC,EAAIsB,KAAKtB,EAAIiB,WAAY,SAAUR,EAAOW,OAAOc,SAAWX,EAAgBA,EAAc,OAAO,CAACnB,EAAG,SAAS,CAACJ,EAAImC,GAAG,aAAa/B,EAAG,SAAS,CAACc,MAAM,CAAC,MAAQ,YAAY,CAAClB,EAAImC,GAAG,mBAAmB/B,EAAG,SAAS,CAACc,MAAM,CAAC,MAAQ,UAAU,CAAClB,EAAImC,GAAG,sBAAsB/B,EAAG,MAAM,CAACE,YAAY,2BAA2B,CAACF,EAAG,SAAS,CAACE,YAAY,mBAAmBY,MAAM,CAAC,KAAO,UAAUV,GAAG,CAAC,MAAQR,EAAIoC,SAAS,CAACpC,EAAImC,GAAG,QAAQ/B,EAAG,SAAS,CAACE,YAAY,qBAAqBY,MAAM,CAAC,KAAO,UAAUV,GAAG,CAAC,MAAQR,EAAIqC,SAAS,CAACrC,EAAImC,GAAG,iBAAiB,IAC30EG,EAAkB,I,oCCDtB,+F,kCCAA,W,+IC6DA,QACEzB,KAAM,kBACN0B,OAAQ,CAAC,EAAX,MACEC,IAAK,EAAP,KACEC,WAAY,CAAd,eACEC,MAAO,CACL3B,MAAO,CACL4B,KAAMC,OACNC,UAAU,IAIdC,KAZF,WAaI,MAAO,CACL7B,WAAY,KACZP,WAAW,IAIfqC,MAAO,CACLhC,MAAO,CACLiC,WAAW,EACXC,QAFN,SAEA,GACQhD,KAAKgB,WAAaiC,KAAKC,MAAMD,KAAKE,UAAUC,IAC5CpD,KAAKS,UAAYT,KAAKqD,WAK5BC,SAAU,CACRD,QADJ,WAEM,OACN,uBACA,uBACA,2BAII3C,eATJ,WAUM,MAAO,CACL6C,KAAMvD,KAAKgB,WAAWuC,KACtBC,KAAMxD,KAAKgB,WAAWwC,MAAQ,aAC9BC,UAAWzD,KAAKgB,WAAWyC,UAC3BC,KAAM1D,KAAKgB,WAAW0C,MAAQ,qBAKpC,QAhDF,WAgDA,kKAEA,2BAFA,uBAGA,qCACA,oCAJA,SAKA,mCALA,OAKA,EALA,OAMA,IACA,0BACA,qCACA,2DATA,8CAcEC,QAAS,CACPxB,OADJ,WAEMnC,KAAK4D,MAAM,QAASX,KAAKC,MAAMD,KAAKE,UAAUnD,KAAKgB,cACnDhB,KAAKS,WAAY,GAGnB2B,OANJ,WAOMpC,KAAKgB,WAAaiC,KAAKC,MAAMD,KAAKE,UAAUnD,KAAKc,QACjDd,KAAKS,WAAY,EAEbT,KAAKqD,SACPrD,KAAK4D,MAAM,WAIfC,SAfJ,WAgBWC,QAAQ,4BAGb9D,KAAK4D,MAAM","file":"js/chunk-92c3baac.b0d7a49c.js","sourcesContent":["import { render, staticRenderFns } from \"./MediaLinkEditor.vue?vue&type=template&id=636b4755&\"\nimport script from \"./MediaLinkEditor.vue?vue&type=script&lang=js&\"\nexport * from \"./MediaLinkEditor.vue?vue&type=script&lang=js&\"\nimport style0 from \"./MediaLinkEditor.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../../node_modules/babel-loader/lib/index.js!../../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MediaLinkEditor.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../../node_modules/babel-loader/lib/index.js!../../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MediaLinkEditor.vue?vue&type=script&lang=js&\"","var pageCache = {};\r\n\r\nexport default (httpClient) => {\r\n\r\n  httpClient.baseURL = 'http://v4.local/'; // !!!\r\n\r\n  return {\r\n    getPage(pageId) {\r\n      if (typeof pageCache[pageId] == 'undefined') {\r\n        pageCache[pageId] = httpClient.get(`/1/cms/pages/${pageId}`);\r\n      }\r\n\r\n      return pageCache[pageId];\r\n    },\r\n\r\n    getDraft(pageId) {\r\n      return httpClient.get(`/1/cms/pages/${pageId}/draft`);\r\n    },\r\n\r\n    saveDraft(pageId, pageData) {\r\n      pageCache[pageId] = undefined;\r\n      return httpClient.put(`/1/cms/pages/${pageId}/draft`, pageData);\r\n    },\r\n\r\n    publish(pageId, pageData = null) {\r\n      return httpClient.put(`/1/cms/pages/${pageId}/publish`, pageData);\r\n    },\r\n\r\n    getUrlDetails(url) {\r\n      return httpClient.get(`/1/proxy/url/details`, { url });\r\n    },\r\n\r\n    uploadBlob(pageId, fileName, blob) {\r\n      let formData = new FormData();\r\n      formData.append('files', blob, fileName);\r\n\r\n      return httpClient.post(`/1/cms/pages/${pageId}/files`, formData);\r\n    },\r\n\r\n    // Registro unico por aca persona-página\r\n    obtainRecord(pageId, personId) {\r\n      return httpClient.get(`/1/cms/people/${personId}/pages/${pageId}/record`);\r\n    },\r\n\r\n    updateRecord(pageId, personId, recordData) {\r\n      return httpClient.put(`/1/cms/people/${personId}/pages/${pageId}/record`, recordData);\r\n    },\r\n\r\n  }\r\n};","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"media-link-editor\"},[_c('UiItem',_vm._b({staticClass:\"ui-clickable\",on:{\"click\":function($event){_vm.isEditing = true}}},'UiItem',_vm.sanitizedValue,false)),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.isEditing),expression:\"isEditing\"}],staticClass:\"link-editor-form\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.innerValue.href),expression:\"innerValue.href\"}],staticClass:\"ui-native\",attrs:{\"type\":\"text\",\"placeholder\":\"http://...\"},domProps:{\"value\":(_vm.innerValue.href)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.innerValue, \"href\", $event.target.value)}}}),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.innerValue.text),expression:\"innerValue.text\"}],staticClass:\"ui-native\",attrs:{\"type\":\"text\",\"placeholder\":\"Titulo\"},domProps:{\"value\":(_vm.innerValue.text)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.innerValue, \"text\", $event.target.value)}}}),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.innerValue.secondary),expression:\"innerValue.secondary\"}],staticClass:\"ui-native\",attrs:{\"type\":\"text\",\"placeholder\":\"Descripcion\"},domProps:{\"value\":(_vm.innerValue.secondary)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.innerValue, \"secondary\", $event.target.value)}}}),_c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.innerValue.target),expression:\"innerValue.target\"}],staticClass:\"ui-native\",on:{\"change\":function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.$set(_vm.innerValue, \"target\", $event.target.multiple ? $$selectedVal : $$selectedVal[0])}}},[_c('option',[_vm._v(\"Destino\")]),_c('option',{attrs:{\"value\":\"_system\"}},[_vm._v(\"Nueva pestaña\")]),_c('option',{attrs:{\"value\":\"_self\"}},[_vm._v(\"Pestaña actual\")])]),_c('div',{staticClass:\"link-editor-form-footer\"},[_c('button',{staticClass:\"ui-button --main\",attrs:{\"type\":\"button\"},on:{\"click\":_vm.accept}},[_vm._v(\"OK\")]),_c('button',{staticClass:\"ui-button --cancel\",attrs:{\"type\":\"button\"},on:{\"click\":_vm.cancel}},[_vm._v(\"Cancel\")])])])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../../node_modules/cache-loader/dist/cjs.js?{\\\"cacheDirectory\\\":\\\"node_modules/.cache/vue-loader\\\",\\\"cacheIdentifier\\\":\\\"08dfcdae-vue-loader-template\\\"}!../../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MediaLinkEditor.vue?vue&type=template&id=636b4755&\"","export * from \"-!../../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MediaLinkEditor.vue?vue&type=style&index=0&lang=scss&\"","<template>\r\n  <div class=\"media-link-editor\">\r\n    <UiItem\r\n      v-bind=\"sanitizedValue\"\r\n      @click=\"isEditing = true\"\r\n      class=\"ui-clickable\"\r\n    />\r\n\r\n    <div\r\n      v-show=\"isEditing\"\r\n      class=\"link-editor-form\"\r\n    >\r\n      <input\r\n        type=\"text\"\r\n        class=\"ui-native\"\r\n        placeholder=\"http://...\"\r\n        v-model=\"innerValue.href\"\r\n      />\r\n      <input\r\n        type=\"text\"\r\n        class=\"ui-native\"\r\n        placeholder=\"Titulo\"\r\n        v-model=\"innerValue.text\"\r\n      />\r\n      <input\r\n        type=\"text\"\r\n        class=\"ui-native\"\r\n        placeholder=\"Descripcion\"\r\n        v-model=\"innerValue.secondary\"\r\n      />\r\n\r\n      <select\r\n        class=\"ui-native\"\r\n        v-model=\"innerValue.target\"\r\n      >\r\n        <option>Destino</option>\r\n        <option value=\"_system\">Nueva pestaña</option>\r\n        <option value=\"_self\">Pestaña actual</option>\r\n      </select>\r\n\r\n      <div class=\"link-editor-form-footer\">\r\n        <button\r\n          type=\"button\"\r\n          class=\"ui-button --main\"\r\n          @click=\"accept\"\r\n        >OK</button>\r\n        <button\r\n          type=\"button\"\r\n          class=\"ui-button --cancel\"\r\n          @click=\"cancel\"\r\n        >Cancel</button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { useApi } from '/packages/api';\r\nimport { UiItem } from '/packages/ui';\r\nimport cmsApi from '../../../../api';\r\n\r\nexport default {\r\n  name: 'MediaLinkEditor',\r\n  mixins: [useApi],\r\n  api: cmsApi,\r\n  components: { UiItem },\r\n  props: {\r\n    value: {\r\n      type: Object,\r\n      required: true,\r\n    },\r\n  },\r\n\r\n  data() {\r\n    return {\r\n      innerValue: null,\r\n      isEditing: false,\r\n    };\r\n  },\r\n\r\n  watch: {\r\n    value: {\r\n      immediate: true,\r\n      handler(newValue) {\r\n        this.innerValue = JSON.parse(JSON.stringify(newValue));\r\n        this.isEditing = this.isEmpty;\r\n      },\r\n    },\r\n  },\r\n\r\n  computed: {\r\n    isEmpty() {\r\n      return (\r\n        !this.innerValue.href &&\r\n        !this.innerValue.text &&\r\n        !this.innerValue.secondary\r\n      );\r\n    },\r\n\r\n    sanitizedValue() {\r\n      return {\r\n        href: this.innerValue.href,\r\n        text: this.innerValue.text || 'Sin título',\r\n        secondary: this.innerValue.secondary,\r\n        icon: this.innerValue.icon || 'mdi:open-in-new',\r\n      };\r\n    },\r\n  },\r\n\r\n  async mounted() {\r\n    // Fetch URL title when url is present and text is empty\r\n    if (this.value.href && !this.value.text) {\r\n      this.innerValue.text = '... fetching ...';\r\n      this.innerValue.secondary = this.value.href;\r\n      let details = await this.$api.getUrlDetails(this.value.href);\r\n      if (details) {\r\n        this.innerValue.text = details.title;\r\n        this.innerValue.secondary = details.description;\r\n        this.$emit('input', JSON.parse(JSON.stringify(this.innerValue)));\r\n      }\r\n    }\r\n  },\r\n\r\n  methods: {\r\n    accept() {\r\n      this.$emit('input', JSON.parse(JSON.stringify(this.innerValue)));\r\n      this.isEditing = false;\r\n    },\r\n\r\n    cancel() {\r\n      this.innerValue = JSON.parse(JSON.stringify(this.value));\r\n      this.isEditing = false;\r\n\r\n      if (this.isEmpty) {\r\n        this.$emit('delete');\r\n      }\r\n    },\r\n\r\n    doDelete() {\r\n      if (!confirm('Eliminar este vínculo ?')) {\r\n        return;\r\n      }\r\n      this.$emit('delete');\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.media-link-editor {\r\n  .link-editor-form {\r\n    padding-left: 50px;\r\n    padding-right: 12px;\r\n\r\n    input {\r\n      display: block;\r\n      width: 100%;\r\n    }\r\n\r\n    .link-editor-form-footer {\r\n      text-align: right;\r\n      margin-top: var(--ui-breathe);\r\n    }\r\n  }\r\n}\r\n</style>"],"sourceRoot":""}